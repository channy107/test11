
{% extends 'unid/navigationbar.html' %}
{% load static %}
{% block content %}
<!-- Page Content -->

<head>
    <link href="{% static 'unid/css/index.css' %}" rel="stylesheet">
    <link href="{% static 'unid/css/contentsupload.css' %}" rel="stylesheet">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<style>
ul {
    margin: 0;
	padding: 0;
	border: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
    list-style: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}
}
.img-replace {
  /* replace text with an image */
  display: inline-block;
  overflow: hidden;
  text-indent: 100%;
  color: transparent;
  white-space: nowrap;
}

.cd-nugget-info {
  text-align: center;
  position: absolute;
  width: 100%;
  height: 50px;
  line-height: 50px;
  bottom: 0;
  left: 0;
}
.cd-nugget-info a {
  position: relative;
  font-size: 14px;
  color: #5e6e8d;
  -webkit-transition: all 0.2s;
  -moz-transition: all 0.2s;
  transition: all 0.2s;
}
.no-touch .cd-nugget-info a:hover {
  opacity: .8;
}
.cd-nugget-info span {
  vertical-align: middle;
  display: inline-block;
}
.cd-nugget-info span svg {
  display: block;
}
.cd-nugget-info .cd-nugget-info-arrow {
  fill: #5e6e8d;
}

/* --------------------------------

Main components

-------------------------------- */
header {
  height: 200px;
  line-height: 200px;
  text-align: center;
  background-color: #5e6e8d;
  color: #FFF;
}
header h1 {
  font-size: 20px;
  font-size: 1.25rem;
}

.cd-popup-trigger {
  display: block;
  width: 300px;
  height: 40px;
  /* line-height: 50px; */
  text-align: center;
  color: #FFF;
  font-size: 14px;
  font-size: 0.95rem;
  text-transform: uppercase;
  border-radius: 0.5em;
  background: #fb2323d1;
  box-shadow: 0 3px 0 rgba(0, 0, 0, 0.07);
}
@media only screen and (min-width: 1170px) {
  .cd-popup-trigger {
    margin: 1em auto;
  }
}

/* --------------------------------

xpopup

-------------------------------- */
.cd-popup, .cd-popup1 {
  position: fixed;
  left: 0;
  top: 0;
  height: 100%;
  width: 100%;
  background-color: rgba(94, 110, 141, 0.9);
  opacity: 0;
  visibility: hidden;
  -webkit-transition: opacity 0.3s 0s, visibility 0s 0.3s;
  -moz-transition: opacity 0.3s 0s, visibility 0s 0.3s;
  transition: opacity 0.3s 0s, visibility 0s 0.3s;
}
.cd-popup.is-visible, .cd-popup1.is-visible {
  opacity: 1;
  visibility: visible;
  -webkit-transition: opacity 0.3s 0s, visibility 0s 0s;
  -moz-transition: opacity 0.3s 0s, visibility 0s 0s;
  transition: opacity 0.3s 0s, visibility 0s 0s;
}
.cd-popup-container1 {
  position: relative;
  width: 90%;
  max-width: 1100px;
  margin: 4em auto;
  background: #FFF;
  border-radius: .25em .25em .4em .4em;
  text-align: center;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
  -webkit-transform: translateY(-40px);
  -moz-transform: translateY(-40px);
  -ms-transform: translateY(-40px);
  -o-transform: translateY(-40px);
  transform: translateY(-40px);
  /* Force Hardware Acceleration in WebKit */
  -webkit-backface-visibility: hidden;
  -webkit-transition-property: -webkit-transform;
  -moz-transition-property: -moz-transform;
  transition-property: transform;
  -webkit-transition-duration: 0.3s;
  -moz-transition-duration: 0.3s;
  transition-duration: 0.3s;
  padding: 30px;
}
.cd-popup-container {
  position: relative;
  width: 90%;
  max-width: 400px;
  margin: 4em auto;
  background: #FFF;
  border-radius: .25em .25em .4em .4em;
  text-align: center;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
  -webkit-transform: translateY(-40px);
  -moz-transform: translateY(-40px);
  -ms-transform: translateY(-40px);
  -o-transform: translateY(-40px);
  transform: translateY(-40px);
  /* Force Hardware Acceleration in WebKit */
  -webkit-backface-visibility: hidden;
  -webkit-transition-property: -webkit-transform;
  -moz-transition-property: -moz-transform;
  transition-property: transform;
  -webkit-transition-duration: 0.3s;
  -moz-transition-duration: 0.3s;
  transition-duration: 0.3s;
  padding: 30px;
}
.cd-popup-container p, .cd-popup-container1 p{
  padding: 3em 1em;
}
.cd-popup-container .cd-buttons:after, .cd-popup-container1 .cd-buttons:after {
  content: "";
  display: table;
  clear: both;
}
.cd-popup-container .cd-buttons li, .cd-popup-container1 .cd-buttons li {
  float: left;
  width: 50%;
  padding: 5px 20px 10px 20px;
  list-style: none;
}
.cd-popup-container .cd-buttons a, .cd-popup-container1 .cd-buttons a {
  display: block;
  height: 40px;
  line-height: 40px;
  text-transform: uppercase;
  color: #FFF;
  -webkit-transition: background-color 0.2s;
  -moz-transition: background-color 0.2s;
  transition: background-color 0.2s;
}
.cd-popup-container .cd-buttons li:first-child a, .cd-popup-container1 .cd-buttons li:first-child a {
  background: #fc7169;
  border-radius: 0 0 0 .25em;
}
.popuprow1 {
    font-weight: bold;
    padding: 30px 20px 50px;
}
.popuprow2 {
    color: grey;
    padding: 0 0 30px 0;
    font-size: 0.95rem;
    text-align: left;
}
.popuprow3 {
    color: grey;
    padding: 0 0 30px 0;
    font-size: 0.8rem;
}

.no-touch .cd-popup-container .cd-buttons li:first-child a:hover, .no-touch .cd-popup-container1 .cd-buttons li:first-child a:hover {
  background-color: #fc8982;
}
.cd-popup-container .cd-buttons li:last-child a, .cd-popup-container1 .cd-buttons li:last-child a {
  background: #b6bece;
  border-radius: 0 0 .25em 0;
}
.no-touch .cd-popup-container .cd-buttons li:last-child a:hover, .no-touch .cd-popup-container1 .cd-buttons li:last-child a:hover {
  background-color: #c5ccd8;
}
.cd-popup-container .cd-popup-close, .cd-popup-container1 .cd-popup-close {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 30px;
  height: 30px;
}
.cd-popup-container .cd-popup-close::before, .cd-popup-container .cd-popup-close::after, .cd-popup-container1 .cd-popup-close::before, .cd-popup-container1 .cd-popup-close::after {
  content: '';
  position: absolute;
  top: 12px;
  width: 14px;
  height: 3px;
  background-color: #8f9cb5;
}
.cd-popup-container .cd-popup-close::before, .cd-popup-container1 .cd-popup-close::before {
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  -o-transform: rotate(45deg);
  transform: rotate(45deg);
  left: 8px;
}
.cd-popup-container .cd-popup-close::after, .cd-popup-container1 .cd-popup-close::after {
  -webkit-transform: rotate(-45deg);
  -moz-transform: rotate(-45deg);
  -ms-transform: rotate(-45deg);
  -o-transform: rotate(-45deg);
  transform: rotate(-45deg);
  right: 8px;
}
.is-visible .cd-popup-container, .is-visible .cd-popup-container1 {
  -webkit-transform: translateY(0);
  -moz-transform: translateY(0);
  -ms-transform: translateY(0);
  -o-transform: translateY(0);
  transform: translateY(0);
  color: black;
}
.popupinformationsrow {
    flex-direction: row;
    display: inline;
}
.popupinformations {
    color: black;
    font-weight: bold;
    float: right;
}

@media only screen and (min-width: 1170px) {
  .cd-popup-container {
    margin: 12em auto;
  }
  .cd-popup-container1 {
    margin: 9em auto;
  }


</style>
<body>
<div class="container1">
    <!-- contents InFo -->
    <div class="contentsuploadrows">
        <h5 class="board-title">컨텐츠 등록</h5>
        <form id="myform" class="form-horizontal" name="writeform" method='post' enctype="multipart/form-data">
          {% csrf_token %}
            <div id="user_file_before">
                <div id="user_file_over">
                    <input type="file"  id="user_files"  name="user_files" class="user_files"  title="파일찾기" multiple/>
                </div>
                <div class="form-group">
                    <label for="inputfiles_before" class="col-sm-2">파일 업로드</label>
                    <input class="form-control col-sm-8 files1"  style="background-color: white;" name="inputfile" id="inputfiles_before" type="text" readonly/>
                    <input class="form-control col-sm-2 files-button" style="background-color: red;color: white;text-align:center;"value="파일 첨부"readonly/>
                    <ul class="str_ul">
                        <li class="tip_str">
                        .hwp, .ppt, .docx, .xlsx 형식의 파일만 가능합니다.
                        </li>
                    </ul>
                </div>
            </div>
            <div id="user_file_after">
                <div class="form-group">
                    <label for="inputfiles_after" class="col-sm-2">파일 업로드</label>
                    <input class="form-control col-sm-8 files1"  style="background-color: white;" name="inputfile_after" id="inputfiles_after" type="text" readonly/>
                    <input class="form-control col-sm-2 files-button" type="button" id="reupload" style="background-color: red;color: white;text-align:center;cursor: pointer;" value="다시 올리기"readonly/>
                </div>
            </div>
            <div id="user_preview_file_before">
                <div id="user_file_over">
                    <input type="file"  id="user_preview_files"  name="user_preview_files" class="user_preview_files"  title="파일찾기" multiple/>
                </div>
                <div class="form-group">
                    <label for="input_previewfiles_before" class="col-sm-2">프리뷰 업로드</label>
                    <input class="form-control col-sm-8 files1"  style="background-color: white;" name="title" id="input_previewfiles_before" type="text" readonly/>
                    <input class="form-control col-sm-2 files-button" style="background-color: red;color: white;text-align:center;"value="파일 첨부"readonly/>
                    <ul class="str_ul">
                        <li class="tip_str">
                        .jpg, .png 형식의 파일만 가능합니다.
                        업로드하지 않을 시 기본 이미지로 등록됩니다.
                        </li>
                    </ul>
                </div>
            </div>
            <div id="user_preview_file_after">
                <div class="form-group">
                    <label for="input_previewfiles_after" class="col-sm-2" >프리뷰 업로드</label>
                    <input class="form-control col-sm-8 files1"  style="background-color: white;" name="title" id="input_previewfiles_after" type="text" readonly/>
                    <input class="form-control col-sm-2 files-button" type="button" id="reupload_preview" style="background-color: red;color: white;text-align:center;cursor: pointer;" value="다시 올리기"readonly/>
                </div>
            </div>
            <div class="form-group">
                <label for="inputtitle" class="col-sm-2" id="contentsName">제목</label>
                <input class="form-control col-sm-10"  name="title" id="inputtitle" type="text">
                <ul class="str_ul">
                    <li class="tip_str">
                    자료의 핵심내용을 알수있도록 30자 내외로 작성해주세요!
                    </li>
                    <li class="byte_str"><span class="col_red" id="body_byte">0</span>자</li>
                </ul>
            </div>
            <div class="form-group">
                <label for="inputcategory" class="col-sm-2" >카테고리</label>
                <select class="form-control col-sm-10" id="inputcategory" name="category">
                    <option title="Combo 1">리포트</option>
                    <option title="Combo 2">강의자료</option>
                    <option title="Combo 3">수업노트</option>
                    <option title="Combo 4">시험자료</option>
                    <option title="Combo 5">동영상</option>
                    <option title="Combo 6">자소서</option>
                    <option title="Combo 7">이력서</option>
                    <option title="Combo 8">전문자료</option>
                    <option title="Combo 9">PPT</option>
                    <option title="Combo 10">논문</option>
                </select>
            </div>
            <div class="form-group">
                <label for="inputfileinfo" class="col-sm-2">파일정보</label>
                <select class="form-control col-sm-10" id="inputfileinfo" name="fileinfo">
                    <option title="Combo 1">PDF</option>
                    <option title="Combo 2">Excel</option>
                    <option title="Combo 3">한글</option>
                    <option title="Combo 4">PPT</option>
                    <option title="Combo 5">Word</option>
                </select>
            </div>
            <div class="form-group">
                <label for="inputtags" class="col-sm-2" >태그</label>
                <input class="form-control col-sm-6 input-lg shortput" id="inputtags"  name="tags" type="text" placeholder="예) #대기업, #취업, #성공적">
                <ul class="str_ul">
                    <li class="tip_str">
                    태그를 입력해주세요. 쉼표로 구분(,) 최대 3개
                    </li>
                </ul>
            </div>
            <div class="form-group">
                <label for="inputauthorinfo" class="col-sm-2">저자</label>
                <input class="form-control col-sm-6 shortput" id="inputauthorinfo" name="authorinfo" type="text">
            </div>
            <div class="form-group">
                <label for="inputtotalpages" class="col-sm-2" name="totalpages">페이지수</label>
                <input class="form-control col-sm-2 creatdate" id="inputtotalpages" name="totalpages">
            </div>
            <div class="form-group">
                <label for="inputpublisheddate" class="col-sm-2">저작시기</label>
                <input type="date" class="form-control col-sm-2 creatdate" id="inputpublisheddate"  name="publisheddate">
            </div>
            <div class="form-group">
                <label for="inputprice" class="col-sm-2">판매 가격</label>
                <input class="form-control col-sm-10 price" id="inputprice" name="price" type="text"/>
                <div class="priceunit">
                    nid
                </div>
            </div>
            <div class="text-group">
                <label for="inputintro">소개글</label>
                <textarea rows="5" class="form-control" id="inputintro" name="intro" placeholder="구매 후 활용 방법, 흐름 등을 소개하여 구매자가 자료를 이해하는데 도움을 줄 수 있습니다."></textarea>
                <!--<textarea rows="5" cols="5" name="body" id="inputtext" class="input_txt_area" onkeydown="inputByte(this, 'body_byte');" onkeyup="inputByte(this, 'body_byte');" ></textarea>-->
                <ul class="str_ul textformtip">
                    <li class="byte_str"><span class="col_red" id="body_byte1">0</span>자</li>
                </ul>
            </div>
            <div class="text-group">
                <label for="inputindex">목차</label>
                <textarea rows="5" class="form-control" id="inputindex"  name="index" placeholder="목차 내용은 검색 결과에 반영되며, 구매 전 자료의 전반적인 흐름을 파악할 수 있게 도와줍니다."></textarea>
                <!--<textarea rows="5" cols="5" name="body" id="inputtext" class="input_txt_area" onkeydown="inputByte(this, 'body_byte');" onkeyup="inputByte(this, 'body_byte');" ></textarea>-->
                <ul class="str_ul textformtip">
                    <li class="byte_str"><span class="col_red" id="body_byte2">0</span>자</li>
                </ul>
            </div>
            <div class="text-group">
                <label for="inputtext">본문 내용</label>
                <textarea rows="5" class="form-control" id="inputtext" name="contents" placeholder="검색한 단어와 일치하는 키워드가 있을 때 검색 결과 상위에 노출됩니다."></textarea>
                <ul class="str_ul textformtip">
                    <li class="byte_str"><span class="col_red" id="body_byte3">0</span>자</li>
                </ul>
            </div>
            <div class="text-group">
                <label for="inputreference">참고 문헌</label>
                <textarea rows="5" class="form-control" id="inputreference" name="reference" placeholder="참고 문헌 입력은 자료 신뢰도를 높일 수 있습니다."></textarea>
                <ul class="str_ul textformtip">
                    <li class="byte_str"><span class="col_red" id="body_byte4">0</span>자</li>
                </ul>
            </div>
            <div class="form-group">
                <label class="col-sm-2">계약 동의서</label>
                <div class="checks">
                    <input type="checkbox" id="ex_chk" name="checkconsensus" >
                    <label for="ex_chk">등록하는 자료의 저작물 판매에 대한 계약/서약에 동의 합니다.</label>
                    <button type="button" class="btn cons" name="cons" id="cons">동의서 보기</button>
                    <div class="cd-popup1" role="alert">
                        <div class="cd-popup-container1">
                            <div class="popuprow1">
                                <h4>저작물 판매에 대한 계약서/서약서</h4>
                            </div>
                            <div class="popuprow3">
                                <textarea style="width: 1000px;height: 300px;" readonly>
                                저작권자인 (성명){{ request.session.user_name }}, (아이디){{ request.session.user_email }} 을 "갑"으로 온라인서비스 제공자인 ㈜지커뮤니케이션을 "을"로 하여 "갑"과 "을" 양 당사자는 저작물 판매(전송, 복제, 배포)에 관한 계약에 대해 동의하며 다음과 같이 계약을 체결한다.

제 1조(계약내용)
 "갑"은 "을"에게 "갑"이 지적재산권을 소유하는 저작물에 관한 사항을 제 2조에 정한 바에 의하여 "을"이 정보통신망을 통하여 "갑"의 저작물의 복제 또는 전송 할 수 있도록 온라인 서비스를 제공 한다 (저작권법 제2조 30호) 온라인 서비스 제공자 요건

제 2조(저작권 이용범위)
 본 계약에 있어서 "을"이 행하는 저작물 서비스 제공 범위는 “을” 이 소유 하는 웹사이트와 “을"과 제휴한 웹사이트에 대해 전송/복제권(디지털 File형태) 이다.

제 3조(계약기간)
 본 계약의 유효기간은 계약일로부터 1년으로 한다. 계약기간의 연장 또는 재계약은 계약기간 만료일 1개월 전까지 "갑","을" 어느 한쪽에서 계약갱신을 원하지 않는다는 통고가 없는 한 이 계약과 동일한 조건으로 자동적으로 갱신된 것으로 본다.

제 4조(수수료율)
 "을"이 "갑"에게 지급할 서비스이용수수료율 및 서비스이용수수료 지급시기에 관해서는 다음과 같이 약정한다.

1. 서비스이용수수료(금액) : 자료 판매 수수료는 등급별(A등급, B등급, C등급, D등급, E등급, F등급) 수수료 정책에 따라 "갑"에게 차등 지급한다. 단, "을"이 제공하는 웹사이트에 따라 서비스이용수수료율은 변동 될 수 있다.

2. 지급방법 : 누적된 출금가능액이 5,500원 초과 시 “갑”이 5,000원 단위로 지급신청을 하면 “을”은 온라인으로 입금한다.

제 5조(분쟁책임)
1. "갑"은 본 계약의 대상이 되는 저작물에 관한 권리에 적합한 소유자임을 확인하며, 당해 저작물과 관련된 저작권 분쟁이 야기되었을 경우에는 "갑"이 전적으로 책임진다.

2. "을"은 본 계약의 대상이 되는 저작물에 대해 권리주장자가 있을 경우 "갑"에게 분쟁사실을 통보 후, 분쟁에 대해 "갑"이 회신하지 않는 경우 저작권 없음을 인정한 것으로 간주하고 “을”의 업무처리 정책에 따라 후속업무를 처리한다.

제 6조(별도계약)
 본 계약약관에 포함되지 아니한 사항은 "갑"과 "을"이 합의하여 결정하여 별도의 계약서를 작성한다.

제 7조(손해배상)
 계약당사자중 어느 일방이 본 계약사항을 위배하였을 때에는 그 상대방은 기간을 정하여 그 위배사항의 시정을 최고한 후 계약해지를 통고할 수 있고 또 본 계약 불이행으로 인한 손해배상을 청구할 수 있다.

제 8조(면책사항)
 천재지변 등 불가항력적 재난이나 전쟁, 소요, 파업 등 사회적 혼란 또는 관련법령의 개폐로 인한 계약불이행은 면책된다.

제 9조(분쟁)
 본 계약과 관련하여 제기된 분쟁이나 소송은 저작권법에 의해 설치된 저작권심의 조정위원회에 부의 하거나 "을"의 소재지를 관할하는 법원으로 한다.

제 10조(적용사항)
 본 계약과 관련하여 해석상 논란이 있는 부분이나 본 계약상에 약정되지 아니한 구체적인 사항에 대해서는 저작권 관계법령 및 일반적인 관행에 따른다.



 온라인서비스 제공자인 (주)지커뮤니케이션 또는 (주)지커뮤니케이션과 제휴한 온라인서비스 제공자(이하 “귀사”)에 대하여 저작물 등록을 신청한 본인 (성명)인준희, (아이디)injh9900 은 귀사에 저작물을 등록 신청함에 있어 다음과 같은 사항을 확인하고, 이에 대하여 본 서약서를 제출합니다.

1. 본인이 등록 신청한 저작물에 대하여, 본인은 저작권법 및 기타 관련법령, 귀사의 약관, 저작물 판매에 관한 계약서를 숙지하였습니다.

2. 본인이 등록 신청한 저작물의 저작권리 일체는 본인에게 있습니다.

3. 본인이 등록 신청한 저작물은 저작권법 및 기타 관련 법령에 저촉되지 않습니다.

4. 본인이 등록 신청한 저작물은 명예훼손, 민,형사상 책임은 본인에게 있습니다.

5. 회원가입 시 또는 저작물 등록 신청 시 귀사에 제공한 본인의 개인정보는 모두 거짓이 없습니다.

 본 저작물의 모든 저자는 본 저작물에 실제적이고 지적인 공헌을 했으며, 저작물의 내용에 대해 일체의 민·형사상의 책임을 부담합니다.
                                </textarea>
                            </div>
                        </div> <!-- cd-popup-container -->
                    </div> <!-- cd-popup -->
                </div>
            </div>
            <div class="row">
                <button type="button" class="cd-popup-trigger" name="enrollcontents" id="enrollcontents"> 콘텐츠 등록 </button>
                <div class="cd-popup" role="alert">
                    <div class="cd-popup-container">
                        <div class="popuprow1">
                            <h4>컨텐츠를 등록하시겠습니까?</h4>
                        </div>
                        <div class="popuprow2">
                            <ul id='popupinfo'>

                            </ul>
                        </div>
                        <div class="popuprow3">
                            컨텐츠는 저자가 책정한 판매가에 따라 구매자가 지불한 니드코인을 통해 보상되며 이더리움 네트워크 사정에 의해 처리속도가 지연될 수 있습니다.
                        </div>

                        <ul class="cd-buttons">
                            <li><a href="#0" class="cd-popup-yes" id="enrollyes" onclick="document.getElementById('myform').submit()">Yes</a></li>
                            <li><a href="#0" class="cd-popup-no">No</a></li>
                        </ul>
                        <a href="#0" class="cd-popup-close img-replace"></a>
                    </div> <!-- cd-popup-container -->
                </div> <!-- cd-popup -->

            </div>
         </form>


</body>
<script src="http://code.jquery.com/jquery-3.1.1.min.js"></script>
<script>

    jQuery(document).ready(function($){
        $('#user_files').on('change', function(){
            var fileee = $('#user_files').get(0).files[0]['name'];
            console.log(fileee);
            $('#inputfiles_after').val(fileee);
            $("#user_file_before").hide();
            $("#user_file_after").show();
        });

        $('#reupload').on('click', function(){
            $("#user_file_after").hide();
            $("#user_file_before").show();
        });

        $('#user_preview_files').on('change', function(){
            var fileee = $('#user_preview_files').get(0).files[0]['name'];
            console.log(fileee);
            $('#input_previewfiles_after').val(fileee);
            $("#user_preview_file_before").hide();
            $("#user_preview_file_after").show();
        });

        $('#reupload_preview').on('click', function(){
            $("#user_file_after").hide();
            $("#user_file_before").show();
        });
        $('#inputintro').on('keyup', function(){
            // 남은 글자 수를 구한다.
            var letterLength = $(this).val().length;
            var inputtext = $(this).val()

            // 문서 객체에 입력한다.
            $('#body_byte1').html(letterLength + "/1000");

            if (letterLength > 1000) {
                alert("1000자를 초과 입력 할 수 없습니다.");
                console.log(inputtext)
                str2 = inputtext.substr(0, 1000);
                console.log(str2.length);
                console.log(str2);
                $('#inputintro').val(str2);
            };
            var afterletterLength = $(this).val().length;
            $('#body_byte1').html(afterletterLength + "/1000");
        });
        $('#inputindex').on('keyup', function(){
            // 남은 글자 수를 구한다.
            var letterLength = $(this).val().length;
            var inputtext = $(this).val()

            // 문서 객체에 입력한다.
            $('#body_byte2').html(letterLength + "/1000");

            if (letterLength > 1000) {
                alert("1000자를 초과 입력 할 수 없습니다.");
                console.log(inputtext)
                str2 = inputtext.substr(0, 1000);
                console.log(str2.length);
                console.log(str2);
                $('#inputindex').val(str2);
            };
            var afterletterLength = $(this).val().length;
            $('#body_byte2').html(afterletterLength + "/1000");
        });
        $('#inputtext').on('keyup', function(){
            // 남은 글자 수를 구한다.
            var letterLength = $(this).val().length;
            var inputtext = $(this).val()

            // 문서 객체에 입력한다.
            $('#body_byte3').html(letterLength + "/1000");

            if (letterLength > 1000) {
                alert("1000자를 초과 입력 할 수 없습니다.");
                console.log(inputtext)
                str2 = inputtext.substr(0, 1000);
                console.log(str2.length);
                console.log(str2);
                $('#inputtext').val(str2);
            };
            var afterletterLength = $(this).val().length;
            $('#body_byte3').html(afterletterLength + "/1000");
        });
        $('#inputreference').on('keyup', function(){
            // 남은 글자 수를 구한다.
            var letterLength = $(this).val().length;
            var inputtext = $(this).val()

            // 문서 객체에 입력한다.
            $('#body_byte4').html(letterLength + "/1000");

            if (letterLength > 1000) {
                alert("1000자를 초과 입력 할 수 없습니다.");
                console.log(inputtext)
                str2 = inputtext.substr(0, 1000);
                console.log(str2.length);
                console.log(str2);
                $('#inputreference').val(str2);
            };
            var afterletterLength = $(this).val().length;
            $('#body_byte4').html(afterletterLength + "/1000");
        });
        $('.cons').on('click', function(event){
            event.preventDefault();
            $('.cd-popup1').addClass('is-visible');
        });

        //close popup
        $('.cd-popup1').on('click', function(event){
            if( $(event.target).is('.cd-popup-close') || $(event.target).is('.cd-popup1') || $(event.target).is('.cd-popup-no')) {
                event.preventDefault();
                $(this).removeClass('is-visible');
            }
        });
        //close popup when clicking the esc keyboard button
        $(document).keyup(function(event){
            if(event.which=='27'){
                $('.cd-popup1').removeClass('is-visible');
            }

        });
        //open popup
        $('.cd-popup-trigger').on('click', function(event){
            event.preventDefault();
            var form = document.writeform;
            if (!form.inputfile_after.value) {
                alert("파일을 첨부해주세요.");
                $('#inputfiles_before').focus();
                return false;
            }
            if (!form.authorinfo.value) {
                alert("저자를 적어주세요");
                $('#inputauthorinfo').focus();
                return false;
            }
            if (!form.totalpages.value) {
                alert("페이지수를 적어주세요");
                $('#inputtotalpages').focus();
                return false;
            }
            if (!form.publisheddate.value) {
                alert("저작시기를 적어주세요");
                $('#inputpublisheddate').focus();
                return false;
            }
            if (!form.price.value) {
                alert("판매 가격을 적어주세요");
                $('#inputprice').focus();
                return false;
            }
            if (!form.intro.value) {
                alert("소개글을 적어주세요");
                $('#inputintro').focus();
                return false;
            }
            if (!form.index.value) {
                alert("목차를 적어주세요");
                $('#inputindex').focus();
                return false;
            }if (!form.contents.value) {
                alert("본문내용을 적어주세요");
                $('#inputtext').focus();
                return false;
            }
            if (!$('input:checkbox[id="ex_chk"]').is(":checked")) {
                alert("계약서에 동의해주세요.");
                $('#ex_chk').focus();
                return false;
            }

            $('.cd-popup').addClass('is-visible');
            let contentsprice = $('#inputprice').val();
            let contentsname = $('#user_files').val();
            console.log(contentsprice);
            let upload_files = $('#user_files').get(0).files
            $('#popupinfo').empty();
            $('#popupinfo').append("<ul class='popupinformationsrow'> <li class='hi' id='popupwriter'>작성자 : </li> <li class='popupinformations'>" + {{ request.session.user_email }} + "</li> </ul><br><br>");
            $('#popupinfo').append("<ul class='popupinformationsrow'> <li class='hi' id='popuptitle'>파일명 : </li> ");
            for(var i=0; i<upload_files.length; i++) {
                $('#popupinfo').append("<li class='popupinformations'>" + $('#user_files').get(0).files[i]['name'] + "</li><br>");
            };
            $('#popupinfo').append("<br><ul class='popupinformationsrow'> <li class='hi' id='popupprice'>가격 : </li> <li class='popupinformations'>" + contentsprice + " nid </li> </ul>");

        });


        
        //close popup
        $('.cd-popup').on('click', function(event){
            if( $(event.target).is('.cd-popup-close') || $(event.target).is('.cd-popup') || $(event.target).is('.cd-popup-no')) {
                event.preventDefault();
                $(this).removeClass('is-visible');
            }
        });
        //close popup when clicking the esc keyboard button
        $(document).keyup(function(event){
            if(event.which=='27'){
                $('.cd-popup').removeClass('is-visible');
            }

        });
    
    });

    var WEB3 = require('web3');
    var web3 = new WEB3();
    web3.setProvider(new web3.providers.HttpProvider("http://localhost:8545"));

    var contentsmasterContract = web3.eth.contract([{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"contents","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"name","type":"string"},{"name":"price","type":"uint32"}],"name":"addContents","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getContentsAddressList","outputs":[{"name":"contentsAddressList","type":"address[]"}],"payable":false,"stateMutability":"view","type":"function"},{"anonymous":false,"inputs":[{"indexed":false,"name":"name","type":"string"}],"name":"EventAddContents","type":"event"}]);


    let cc = contentsmasterContract.at( "0xbf5f1204ba8ee3bc0096459e9b80099d4fee2a7a" );

    var contentsContract = web3.eth.contract([{"constant":false,"inputs":[],"name":"countUp","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getDownloadCount","outputs":[{"name":"","type":"uint32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getContentsPrice","outputs":[{"name":"","type":"uint32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getContentsName","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"name","type":"string"},{"name":"price","type":"uint32"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"count","type":"uint32"}],"name":"EventCountUp","type":"event"}]);

    $(function() {
        $('#enrollyes').click(function() {
            let contentsprice = $('#inputprice').val();
            let contentsname = $('#user_files').val();
            cc.addContents (
                contentsname,
                contentsprice,
                { from: web3.eth.coinbase, gas: 1000000 },
                function(err, res) {
                    if (!err) {
                        console.log(res);
                    } else {
                        console.error(err);
                    }
                }
            );       
        });
    });

</script>



{% endblock %}



